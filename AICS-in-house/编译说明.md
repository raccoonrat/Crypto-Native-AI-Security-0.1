# LaTeX 文档编译说明

## 文件说明

- `内容安全平台架构设计_Linus视角.tex` - 主 LaTeX 文档
- `mermaid_diagrams.md` - 独立的 Mermaid 图表代码

## 编译要求

### 必需软件

1. **LaTeX 发行版**：
   - Windows: [MiKTeX](https://miktex.org/) 或 [TeX Live](https://www.tug.org/texlive/)
   - macOS: [MacTeX](https://www.tug.org/mactex/)
   - Linux: `sudo apt-get install texlive-full` (Ubuntu/Debian)

2. **中文支持**：
   - 需要安装 `ctex` 和 `xeCJK` 包
   - 使用 XeLaTeX 编译器（支持中文）

3. **必需包**：
   - `ctex` - 中文支持
   - `xeCJK` - 中日韩字符支持
   - `tikz` - 绘图（已包含在大多数发行版中）
   - `listings` - 代码高亮
   - `algorithm` 和 `algorithmic` - 算法伪代码

### 安装缺失的包

如果编译时提示缺少包，可以：

**MiKTeX (Windows)**:
- 自动提示安装，点击"安装"即可

**TeX Live (Linux/macOS)**:
```bash
sudo tlmgr install <package-name>
```

## 编译方法

### 方法一：命令行编译（推荐）

```bash
# 使用 XeLaTeX 编译（支持中文）
xelatex 内容安全平台架构设计_Linus视角.tex

# 如果需要交叉引用，需要编译两次
xelatex 内容安全平台架构设计_Linus视角.tex
xelatex 内容安全平台架构设计_Linus视角.tex
```

### 方法二：使用编辑器

**VS Code**:
1. 安装扩展 "LaTeX Workshop"
2. 打开 `.tex` 文件
3. 按 `Ctrl+Alt+B` (Windows/Linux) 或 `Cmd+Option+B` (macOS) 编译
4. 按 `Ctrl+Alt+V` 预览 PDF

**TeXstudio**:
1. 打开 `.tex` 文件
2. 点击"构建并查看"按钮（或按 F5）

**Overleaf** (在线):
1. 上传 `.tex` 文件到 [Overleaf](https://www.overleaf.com/)
2. 选择编译器为 "XeLaTeX"
3. 点击 "Recompile"

## Mermaid 图表使用

### 方法一：在 Markdown 中直接使用

如果您的编辑器支持 Mermaid（如 Typora、Obsidian、GitHub），可以直接使用 `mermaid_diagrams.md` 中的代码。

### 方法二：转换为图片插入 LaTeX

1. **在线转换**：
   - 访问 [Mermaid Live Editor](https://mermaid.live/)
   - 粘贴 Mermaid 代码
   - 导出为 PNG 或 SVG
   - 在 LaTeX 中使用：
   ```latex
   \includegraphics[width=\textwidth]{diagram.png}
   ```

2. **使用 Mermaid CLI**：
   ```bash
   # 安装
   npm install -g @mermaid-js/mermaid-cli
   
   # 转换
   mmdc -i mermaid_diagrams.md -o diagrams.png
   ```

3. **使用 Python**：
   ```bash
   pip install mermaid
   # 然后使用 Python 脚本转换
   ```

### 方法三：在 LaTeX 中直接使用 Mermaid（高级）

如果使用 LuaLaTeX，可以尝试 `mermaid` 包：

```latex
\usepackage{mermaid}
\begin{mermaid}
graph TD
    A --> B
\end{mermaid}
```

**注意**：此方法需要额外配置，可能不稳定。

## 常见问题

### 1. 中文显示乱码

**解决方案**：
- 确保使用 XeLaTeX 编译器，而不是 pdfLaTeX
- 检查系统字体是否支持中文

### 2. TikZ 图表不显示

**解决方案**：
- 确保安装了 `tikz` 包
- 如果使用 MiKTeX，可能需要手动安装 `pgf` 包

### 3. 代码高亮不工作

**解决方案**：
- 确保安装了 `listings` 包
- 检查 `\lstset` 配置是否正确

### 4. 算法环境报错

**解决方案**：
- 确保安装了 `algorithm` 和 `algorithmic` 包
- 某些发行版可能需要 `algorithmicx` 替代 `algorithmic`

## 输出文件

编译成功后，会生成以下文件：

- `内容安全平台架构设计_Linus视角.pdf` - 最终 PDF 文档
- `内容安全平台架构设计_Linus视角.aux` - 辅助文件（交叉引用）
- `内容安全平台架构设计_Linus视角.log` - 编译日志
- `内容安全平台架构设计_Linus视角.out` - 书签输出

**注意**：`.aux`, `.log`, `.out` 等文件可以删除，但保留它们有助于下次编译时处理交叉引用。

## 推荐工作流程

1. **首次编译**：
   ```bash
   xelatex 内容安全平台架构设计_Linus视角.tex
   ```

2. **处理交叉引用**（如果需要）：
   ```bash
   xelatex 内容安全平台架构设计_Linus视角.tex
   xelatex 内容安全平台架构设计_Linus视角.tex
   ```

3. **查看 PDF**：
   - 使用 PDF 阅读器打开生成的 PDF 文件
   - 或在编辑器中预览

## 自定义配置

如果需要修改文档样式，可以编辑 `.tex` 文件中的以下部分：

- **页面设置**：`\geometry` 命令
- **代码样式**：`\lstset` 配置
- **颜色方案**：TikZ 图表中的 `fill` 颜色
- **字体大小**：`\documentclass` 选项

## 技术支持

如果遇到编译问题：

1. 查看 `.log` 文件中的错误信息
2. 检查是否所有必需的包都已安装
3. 确保使用 XeLaTeX 编译器
4. 尝试在 [Overleaf](https://www.overleaf.com/) 上编译，验证是否是本地环境问题

